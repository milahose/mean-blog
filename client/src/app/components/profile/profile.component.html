<div class="container">

	<div class="row mt-4">
		<div class="col-md-8 mt-4">
			<h1 class="text-center">Profile</h1>
			
			<h3 class="mb-3">Published Posts</h3>

			<div class="col-md-12 show-hide-message">
				<div [ngClass]="msgClass">
					{{ msg }}
					<button [hidden]="!msg" type="button" class="close" data-dismiss="alert" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
			</div>
			
			<div *ngFor="let post of posts; let i = index;">
				<div class="card mb-4" *ngIf="post">
					<img class="card-img-top" src="http://placehold.it/750x300" alt="Card image cap">
					<div class="card-body">
						<h2 class="card-title"><a [routerLink]="['/blog', post?.title.toLowerCase().split(' ').join('-')]">{{post?.title}}</a></h2>
						<p>By <a [routerLink]="['/profile', post.username]">{{user?.firstname}} {{user?.lastname}}</a> {{formatDate(post?.date)}}</p>
						<p class="card-text">
							<span [ngClass]="['post-body-' + i]"></span>
							{{parseHTML(post, i)}}
							<a [routerLink]="['/blog', post.title.toLowerCase().split(' ').join('-')]">Read More &#8811;</a>
						</p>
						<div class="tags">
							<a href="" class="badge badge-pill badge-info m-1">JavaScript</a>
							<a href="" class="badge badge-pill badge-info m-1">React</a>
							<a href="" class="badge badge-pill badge-info m-1">Nodejs</a>
							<a href="" class="badge badge-pill badge-info m-1">PHP</a>
							<a href="" class="badge badge-pill badge-info m-1">Ruby</a>
						</div>
						<div class="mt-3 buttons float-right" *ngIf="allowEdits">
							<button class="btn btn-primary mr-2" (click)="handleEditClick($event, post)">Edit</button>
							<button class="btn btn-danger" data-toggle="modal" data-target="#deleteModal">Delete</button>
						</div>
					</div>
			</div>

				<!-- Modals -->
				<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalTitle"
					aria-hidden="true">
					<div class="modal-dialog" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="exampleModalLongTitle">Delete Blog?</h5>
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>
							<div class="modal-body">
								Deleting a blog post is permenant and cannot be undone. Are you sure you want to delete this blog?
							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
								<button type="button" class="btn btn-danger" data-dismiss="modal" 
									(click)="deletePost(post)">Delete</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="col-md-4 sidebar">
			<div class="card my-4">
				<h5 class="card-header text-center">{{user?.firstname}} {{user?.lastname}}</h5>
				<div class="card-body" *ngIf="allowEdits">
					<p><strong>Username:</strong> {{user?.username}}</p>
					<p><strong>Email:</strong> {{user?.email}}</p>
					<p><strong>Account Created:</strong> {{createdOn}}</p>
				</div>
			</div>

			<div class="card my-4" *ngIf="allowEdits">
				<h5 class="text-center mt-4	">New Blog Post</h5>
				<div class="card-body">
					<p class="text-center">
						<button class="btn btn-info" (click)="handleNewBlogClick($event)">Begin</button>
					</p>
				</div>
			</div>
		</div>
	</div>
</div>

